let userData,signUpToggle=document.getElementById("signup"),signInToggle=document.getElementById("signin"),signincontainer=document.getElementById("signincontainer"),signupcontainer=document.getElementById("signupcontainer"),signUpSuccessContainer=document.getElementById("sign-up-msg-container-sign-in-up-page"),signupBtn=document.getElementById("signupButton"),signinBtn=document.getElementById("signinButton"),forgotPasswordBtn=document.getElementById("forgot_password"),preloader=document.getElementById("preloader_container"),bg1=document.getElementById("bg1"),bg2=document.getElementById("bg2"),bg3=document.getElementById("bg3"),bg4=document.getElementById("bg4"),text=window.location.hash.substring(1),lastToastTimestamp=Date.now();const apiURL="https://whispering-ridge-40670.herokuapp.com";function setUpSignInSignUpPage(){signinBtn.addEventListener("click",async s=>{s.preventDefault();const e=document.getElementById("signinemail").value,t=document.getElementById("signinpassword").value;if(!e||!t)return show_toast(2,"Please fill all the details properly!");if(!validateEmail(e))return show_toast(2,"Please Enter a valid email!");preloader.style.display="block";try{const s=await fetch(`${apiURL}/auth/signin`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await s.json();if(400==s.status)show_toast(2,"User does not exists, Please sign up!"),preloader.style.display="none";else if(404==s.status)show_toast(2,"Please Enter a valid email!"),preloader.style.display="none";else if(444==s.status)show_toast(2,"PLease Enter valid password!"),preloader.style.display="none";else if(500==s.status)show_toast(0,"Internal server error please re-try!"),preloader.style.display="none";else{const{token:s}=a;localStorage.setItem("jwt",s);const e=await fetch(`${apiURL}/user/getdetails`,{method:"GET",headers:{authorization:s}}),t=await e.json();(userData=t.data).is_admin?window.location.href="./general/admin_main_page.html":window.location.href="./homepage.html"}}catch(s){show_toast(0,"Internal server error please re-try!"),preloader.style.display="none"}}),signupBtn.addEventListener("click",async s=>{s.preventDefault();const e=document.getElementById("signupemail").value,t=document.getElementById("name").value,a=document.getElementById("signuppassword").value,l=document.getElementById("mobile").value,o=document.getElementById("confirm").value;if(!(e&&a&&t&&l))return show_toast(2,"Please fill all the details properly!");if(!validateEmail(e))return show_toast(2,"Please Enter a valid email!");if(10!=l.length)return show_toast(2,"Mobile no. should be of 10 length!");if(a!=o)return show_toast(2,"Passwords not matched with confirm password!");let n=passValidator(a);if(!n[0])return show_toast(2,`${n[1]}`);preloader.style.display="block";const i=await fetch(`${apiURL}/auth/signup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_name:t,email:e,password:a,mobile:l})}),g=await i.json();if(400==i.status)show_toast(2,"User already exists, Please sign in!"),preloader.style.display="none";else if(404==i.status)show_toast(2,"Please Enter a valid email!"),preloader.style.display="none";else if(444==i.status)show_toast(2,`${g.error}`),preloader.style.display="none";else if(500==i.status)show_toast(0,"Internal server error please re-try!"),preloader.style.display="none";else{const s=g.data;localStorage.setItem("jwt",s),console.log("hehe"),signUpSuccessContainer.style.display="flex"}}),forgotPasswordBtn.addEventListener("click",async()=>{preloader.style.display="block";const s=document.getElementById("signinemail").value,e=await fetch(`${apiURL}/auth/forgotpasswordsignin`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s})});400==e.status?(preloader.style.display="none",show_toast(2,"Please enter registered email-id!")):404==e.status?(show_toast(2,"Please Enter a valid email!"),preloader.style.display="none"):500==e.status?(preloader.style.display="none",show_toast(0,"Error occured re-try!"),console.log(err)):(preloader.style.display="none",show_toast(1,"Link to reset password has been sent to your email-id!"))}),"signin"==text&&(signincontainer.classList.toggle("display-class"),signincontainer.classList.toggle("opacity-class"),signupcontainer.classList.toggle("opacity-class"),signupcontainer.classList.toggle("display-class"),bg1.classList.toggle("opacity-class"),bg2.classList.toggle("opacity-class"),bg3.classList.toggle("opacity-class"),bg4.classList.toggle("opacity-class"),bg1.classList.toggle("display-class"),bg2.classList.toggle("display-class"),bg3.classList.toggle("display-class"),bg4.classList.toggle("display-class")),signInToggle.addEventListener("click",()=>{signupcontainer.classList.toggle("opacity-class"),signincontainer.classList.toggle("opacity-class"),signupcontainer.classList.toggle("display-class"),signincontainer.classList.toggle("display-class"),bg1.classList.toggle("opacity-class"),bg2.classList.toggle("opacity-class"),bg3.classList.toggle("opacity-class"),bg4.classList.toggle("opacity-class"),bg1.classList.toggle("display-class"),bg2.classList.toggle("display-class"),bg3.classList.toggle("display-class"),bg4.classList.toggle("display-class")}),signUpToggle.addEventListener("click",()=>{signupcontainer.classList.toggle("opacity-class"),signincontainer.classList.toggle("opacity-class"),signupcontainer.classList.toggle("display-class"),signincontainer.classList.toggle("display-class"),bg1.classList.toggle("opacity-class"),bg2.classList.toggle("opacity-class"),bg3.classList.toggle("opacity-class"),bg4.classList.toggle("opacity-class"),bg1.classList.toggle("display-class"),bg2.classList.toggle("display-class"),bg3.classList.toggle("display-class"),bg4.classList.toggle("display-class")}),preloader.style.display="none",AOS.init({easing:"ease-in-out",once:!0,duration:600})}function show_toast(s,e){if(Date.now()-lastToastTimestamp>5e3){let t=document.getElementById("toastAlertMessage"),a=document.getElementById("toastImage"),l=document.getElementById("toastFrontMessage"),o=document.getElementById("toastDescriptionMessage"),n=e.length+7;document.getElementById("toastAlertMessage").style.setProperty("--foo",`${n}ch`),1==s?(a.src="../assets/_general/success_tick.svg",l.style.backgroundColor="green"):0==s?(a.src="../assets/_general/error_cross.svg",l.style.backgroundColor="red"):(a.src="../assets/_general/neutral_exclamation.svg",l.style.backgroundColor="black"),o.innerText=" ",setTimeout(function(){o.innerText=e},600),setTimeout(function(){o.innerText=" "},4200),t.className="toastPopUp",setTimeout(function(){t.className=t.className.replace("toastPopUp","")},5e3),lastToastTimestamp=Date.now()}else setTimeout(function(){show_toast(s,e)},5500-(Date.now()-lastToastTimestamp))}function validateEmail(s){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(s)}setTimeout(()=>{setUpSignInSignUpPage()},200);let regularExpression=/^(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{6,}$/;function passValidator(s){let e;return s.length<6?[!1,e="Password should be minimum of 6 length!"]:s.length>20?[!1,e="Password should be maximum of 20 length!"]:s.search(/[A-Z]/)<0?[!1,e="Password should contain atleast 1 uppercase letter!"]:s.search(/[a-z]/)<0?[!1,e="Password should contain atleast 1 lowercase letter!"]:s.search(/[0-9]/)<0?[!1,e="Password should contain atleast 1 digit!"]:-1!=s.search(" ")?[!1,e="Password should not contain any spaces!"]:regularExpression.test(s)?[!0,"Success"]:[!1,e="Password should contain atleast 1 special character!"]}